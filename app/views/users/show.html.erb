<h1><%= @user.name %></h1>

<p>
  <strong>Email:</strong>
  <%= @user.email %>
</p>

<p>
  <strong>Created:</strong>
  <%= @user.created_at.strftime("%B %d, %Y") %>
</p>

<!-- Add balance information -->
<div style="margin-top: 20px; padding: 15px; border: 1px solid #ccc;">
  <h3>Financial Summary</h3>
  <p><strong>Total Paid:</strong> $<%= @user.total_paid %></p>
  <p><strong>Total Owed:</strong> $<%= @user.total_owed %></p>
  <p><strong>Net Balance:</strong>
    <span style="color: <%= @user.net_balance >= 0 ? 'green' : 'red' %>">
      $<%= @user.net_balance %>
    </span>
    <% if @user.net_balance > 0 %>
      (You are owed money)
    <% elsif @user.net_balance < 0 %>
      (You owe money)
    <% else %>
      (All settled up!)
    <% end %>
  </p>
</div>

<% if @user.charity_donations.any? %>
  <h3>Charity Impact ðŸŽ‰</h3>
  <p>Every extra penny you pay gets matched and donated to charity!</p>

  <div class="charity-donations">
    <p>
      <strong>Total donations generated: $<%= @user.charity_donations.sum(:amount_cents) / 100.0 %></strong>
      (Your extra pennies + Splitwise matching)
    </p>

    <h4>Recent Donations:</h4>
    <ul>
      <% @user.charity_donations.includes(:expense_share => :expense).limit(5).each do |donation| %>
        <li>
          <%= donation.charity_name %> -
          <%= donation.amount_cents %> cents
          (from <%= donation.expense_share.expense.description %>)
        </li>
      <% end %>
    </ul>
  </div>
<% end %>

<div>
  <%= link_to 'Edit', edit_user_path(@user) %>
  <%= link_to 'Delete', @user, data: { turbo_method: :delete },
              confirm: 'Are you sure?' %>
  <%= link_to 'Back to Users', users_path %>
</div>
